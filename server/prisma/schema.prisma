generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model projects {
  id        String      @id @default(uuid()) @db.Uuid
  title     String      @default("New Project")
  documents documents[]
  maps      maps[]
  boards    boards[]
}

model documents {
  id          String   @id @default(uuid()) @db.Uuid
  title       String   @default("New Document")
  content     Json?
  tags        String[] @default([])
  icon        String?  @default("mdi:file")
  parent      String?  @db.Uuid
  expanded    Boolean  @default(false)
  folder      Boolean  @default(false)
  public      Boolean  @default(false)
  sort        Int      @default(0)
  template    Boolean  @default(false)
  properties  Json?
  alter_names String[] @default([])

  // Relations
  project    projects @relation(fields: [project_id], references: [id], onDelete: Cascade)
  project_id String   @db.Uuid
  nodes      nodes[]
}

model maps {
  id        String   @id @default(uuid()) @db.Uuid
  title     String   @default("New Map")
  folder    Boolean  @default(false)
  public    Boolean  @default(false)
  expanded  Boolean  @default(false)
  sort      Int      @default(0)
  tags      String[] @default([])
  parent    String?  @db.Uuid
  map_image String?

  project    projects @relation(fields: [project_id], references: [id])
  project_id String   @db.Uuid

  map_pins   map_pins[]
  map_layers map_layers[]
}

model map_pins {
  id              String  @id @default(uuid()) @db.Uuid
  parent          String  @db.Uuid
  lat             Float
  lng             Float
  color           String  @default("#ffffff")
  backgroundColor String  @default("#000000")
  icon            String
  public          Boolean @default(true)
  text            String?
  map_link        String? @db.Uuid
  doc_id          String? @db.Uuid
  maps            maps?   @relation(fields: [parent], references: [id])
}

model map_layers {
  id     String  @id @default(uuid()) @db.Uuid
  title  String  @default("New Layer")
  image  String?
  parent String  @db.Uuid
  public Boolean @default(false)
  maps   maps?   @relation(fields: [parent], references: [id])
}

model boards {
  id               String  @id @default(uuid()) @db.Uuid
  title            String  @default("New Board")
  folder           Boolean @default(false)
  public           Boolean @default(false)
  expanded         Boolean @default(false)
  sort             Int     @default(0)
  parent           String? @db.Uuid
  defaultNodeColor String  @default("#595959")
  defaultEdgeColor String  @default("#595959")

  project    projects @relation(fields: [project_id], references: [id])
  project_id String   @db.Uuid
  nodes      nodes[]
  edges      edges[]
}

model nodes {
  id                String  @id @default(uuid()) @db.Uuid
  label             String?
  width             Int     @default(50)
  height            Int     @default(50)
  x                 Float   @default(0)
  y                 Float   @default(0)
  type              String  @default("rectangle")
  fontSize          Int     @default(16)
  fontColor         String  @default("#ffffff")
  fontFamily        String  @default("Lato")
  textVAlign        String  @default("center")
  textHAlign        String  @default("center")
  backgroundColor   String  @default("#595959")
  backgroundOpacity Float   @default(1)

  locked   Boolean @default(false)
  template Boolean @default(false)
  zIndex   Int     @default(1)

  board        boards     @relation(fields: [parent], references: [id])
  document     documents? @relation(fields: [doc_id], references: [id])
  doc_id       String?    @db.Uuid
  parent       String     @db.Uuid
  edges_source edges[]    @relation("edges_source")
  edges_target edges[]    @relation("edges_target")
}

model edges {
  id                    String  @id @default(uuid()) @db.Uuid
  label                 String?
  curveStyle            String  @default("straight")
  lineStyle             String  @default("solid")
  lineColor             String  @default("#595959")
  controlPointDistances Int     @default(-100)
  controlPointWeight    Float   @default(0.5)
  taxiDirection         String  @default("auto")
  taxiTurn              Int     @default(50)
  targetArrowShape      String  @default("triangle")
  sourceArrowShape      String  @default("none")
  midSourceArrowShape   String  @default("none")
  midTargetArrowShape   String  @default("none")
  fontSize              Int     @default(16)
  fontColor             String  @default("#ffffff")
  fontFamily            String  @default("Lato")
  zIndex                Int     @default(1)

  board     boards @relation(fields: [parent], references: [id])
  source    nodes  @relation("edges_source", fields: [source_id], references: [id])
  target    nodes  @relation("edges_target", fields: [target_id], references: [id])
  source_id String @db.Uuid
  target_id String @db.Uuid
  parent    String @db.Uuid
}
